---
title: 将 MSG 导出为 PNG 的 C# API
description: 在 .NET 上不使用 Microsoft Word 或 Outlook 将 MSG 转换为 PNG
url_ignore: /zh/net/conversion/msg-to-png/
family: total
platformtag: net
feature: conversion
informat: MSG
outformat: PNG
otherformats: DOCX XPS WORDML DOT SVG TIFF OTT ODT EMF FLATOPC EPUB DOC GIF TEXT MD PDF DOTX PNG RTF PCL PS DOCM JPEG DOTM
---
{{< blocks/products/pf/feature-page-wrap >}}
{{< blocks/products/pf/i18n/feature-page-header h1="通过 .NET 将 MSG 导出到 PNG" h2=".NET API 在 Windows、macOS 和 Linux 上将 MSG 渲染为 PNG，而无需使用 Word 或 Outlook" >}}

{{% blocks/products/pf/feature-page-summary %}}
如果您是一名 .NET 开发人员，希望在您的应用程序中添加 MSG 到 PNG 转换功能，那么 [Aspose.Total for .NET](https://products.aspose.com/total/net/) 文件格式操作 API 是一种方式向前。通过使用 [Aspose.Email for .NET](https://products.aspose.com/email/net/)，您可以将 MSG 文件格式转换为 HTML。之后，通过使用 [Aspose.Words for .NET](https://products.aspose.com/words/net/)，您可以将 HTML 渲染为 PNG。
{{% /blocks/products/pf/feature-page-summary  %}}

{{< blocks/products/pf/agp/feature-section >}}
{{% blocks/products/pf/agp/feature-section-col title="C# API 将 MSG 转换为 PNG" %}}
1. 使用 [MailMessage](https://reference.aspose.com/msg/net/aspose.msg/mailmessage) 类打开 MSG 文件
2. 使用 [Save](https://reference.aspose.com/msg/net/aspose.msg.mailmessage/save/methods/3) 方法将 MSG 转换为 HTML
3. 使用 [Document](https://reference.aspose.com/words/net/aspose.words/document) 类加载 HTML
4. 使用 [Save](https://reference.aspose.com/words/net/aspose.words.document/save/methods/4) 方法将文档保存为 PNG 格式，并将 Png 设置为 SaveFormat
{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/agp/feature-section-col title="转换要求" %}}
从命令行安装为 ```nuget install Aspose.Total``` 或通过 Visual Studio 的包管理器控制台使用 ```Install-Package Aspose.Total```。

或者，从 [下载](https://releases.aspose.com/total/net) 获取 ZIP 文件中的离线 MSI 安装程序或 DLL。
{{% /blocks/products/pf/agp/feature-section-col %}}

{{% blocks/products/pf/feature-page-code %}}
{{< gist "aspose-com-gists" "5a9fece649991cb4d3f82988b0979ef7" "convert-email-formats-to-images.cs" >}}
{{% /blocks/products/pf/feature-page-code %}}
{{< /blocks/products/pf/agp/feature-section >}}

{{% blocks/products/pf/feature-page-section  h2="通过 .NET 解析 MSG 文件" %}}
在将 MSG 转换为 PNG 之前，如果您想确保您正在转换正确的电子邮件，您可以加载 MSG 文档，对其进行解析并查看您想要的属性。通过使用 [Aspose.Email for .NET](https://products.aspose.com/msg) 的 [MapiMessage](https://reference.aspose.com/msg/net/aspose.msg.mapi/mapimessage) 类/net/) API，可以获取发件人和收件人信息。例如，您可以使用 [SenderName](https://reference.aspose.com/msg/net/aspose.msg.mapi/mapimessage/properties/sendername) 属性检查转换的特定发件人电子邮件。  
{{% blocks/products/pf/feature-page-code %}}
{{< gist "aspose-com-gists" "5a9fece649991cb4d3f82988b0979ef7" "parse-email-files.cs" >}}
{{% /blocks/products/pf/feature-page-code  %}}
{{% /blocks/products/pf/feature-page-section %}}

{{% blocks/products/pf/feature-page-section  h2="通过 .NET 限制 PNG 文档编辑" %}}
在将文档从 MSG 保存到 PNG 时，您可能需要保护您的输出文档。有时您可能需要限制编辑文档的能力，只允许对其进行某些操作。这对于防止其他人编辑您文档中的敏感和机密信息很有用。 [Aspose.Words for .NET](https://products.aspose.com/words/net/) API，使您能够使用 [ProtectionType](https://reference.aspose.com/words/net/aspose.words/protectiontype) 枚举参数。您可以使用以下代码行将文档设置为只读。 
{{% blocks/products/pf/feature-page-code %}}

```cs

Document document = new Document("HtmlOutput.html");

document.Protect(ProtectionType.ReadOnly, "password");

document.Save("output.png", SaveFormat.Png);  
```

{{% /blocks/products/pf/feature-page-code  %}}
{{% /blocks/products/pf/feature-page-section %}}

{{% blocks/products/pf/feature-page-section  h2="以编程方式将 MSG 文件转换为 PNG：用例" %}}
MSG 文件用于存储基于文本的消息，因此非常适合用于发送和接收文本数据。然而，当处理视觉内容时，像 PNG 这样的图像格式就变得至关重要，因为它们用于创建静态的图形和插图。

将 MSG 文件转换为 PNG 格式是必要的，以充分发挥其视觉呈现和分析能力的潜力。这种转换使您能够：

**用途：**

* **社交媒体内容分享**：将 MSG 文件转换为在 Facebook、Twitter 或 Instagram 等社交媒体平台上共享消息，并添加图像或视频等视觉元素。
* **文本到图像合成**：使用 PNG 生成从文本输入中创建的图像，制作出色地用于演示、报告或营销材料中的可视化图形。
* **聊天机器人集成**：将 MSG 文件转换为与消息应用集成聊天机器人，使用户能够与 bots 交互，并访问图像或视频等视觉内容。
* **文档生成**：使用 PNG 创建包含视觉元素（如图表、信息图或截图）的交互式文档，帮助用户更轻松地理解复杂的信息。
* **电子邮件新闻简报设计**：将 MSG 文件转换为设计富有吸引力的电子邮件新闻简报，包含图像、文本和其他多媒体元素，以提高用户参与度和转化率。
{{% /blocks/products/pf/feature-page-section %}}
{{< blocks/products/pf/main-wrap-class isAutogenPage="true" >}}

{{< blocks/products/pf/agp/other-autogen-total >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< /blocks/products/pf/feature-page-wrap >}}